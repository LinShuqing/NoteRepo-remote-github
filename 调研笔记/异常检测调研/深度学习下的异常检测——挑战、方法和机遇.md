# 深度学习下的异常检测——挑战、方法和机遇

## 挑战和方法
1. 什么是异常：过于远离大多数数据的点
	1. 少
	2. 不规则
2. 两种视角：
	1. 分类：是异常点或者不是
	2. 打分：评分进行排名（更通用）
3. 三种异常：
	1. 点异常
	2. 条件异常
	3. 组异常
4. 关键挑战：
	1. 异常检测率低
	2. 语境和高维数据（异常仅在时间、空间和图形数据中隐含关系的上下文中可见）
	3. 采用高效学习（使用有限数量的标记异常数据构建通用检测模型）
	4. 抗噪异常检测（数据可能包含没有标签的正常和异常实例（异常污染））
	5. 复杂异常（条件异常、组异常、多维异常等）
	6. 异常解释
5. 传统方法：
	1. 基于统计和概率的方法
	2. 基于邻近的方法
	3. 浅层机器学习模型
	4. 其他方法（如基于信息理论、子空间等）
6. 传统方法的缺点：
	1. 捕捉复杂关系的能力弱
	2. 需要很多人工特征
7. 深度学习方法的优点
	1. 生成新学的特征空间
	2. 端到端学习
	3. 强大的特征学习
	4. 多样化的神经网络架构
	5. 更高准确性的异常模型
8. 深度学习方法的三个主要类型
	1. 深度学习特征提取
	2. 学习正常样本的特征表示
	3. 端到端的异常得分学习
	4. 更多细节分类见[[Deep Learning for Anomaly Detection- A Review.pdf]]
9. 基于监督的分类：
	1. 无监督学习：处理异常和未标记的数据
		1. 收集数据成本过高
	2. 半监督学习（**当前热门！！！**）：假设一组手动标记的正常训练数据的可用性，当前许多基于深度学习的方法
		1. 方便获得大量正常数据
	3. 弱监督方法：有异常类的标签，但标签是局部的、不精确的
		1. 容易获取少量手动标记的异常

## 方法
### 模型视角
#### 深度学习特征提取
1. 步骤：
	1. 一个神经网络单独提取特征（可以采用预训练或直接训练的模型）
	2. 在特征空间中计算得分进行异常检测
> 两个步骤完全分离
3. 优缺点：
	1. 优点
		1. 预训练模型容易获得
		2. 更强大的降维能力
		3. 实现简单
	2. 缺点
		1. 特征提取和异常评分完全不相关
		2. 预训练的深度模型通常受限于特定数据
		3. 现有异常测量的局限
		
#### 学习正常样本的特征表示
将特征学习和异常评分相结合，而非两者完全解耦
1. 两个方法
	1. 采取深度学习的方法学习正常样本的特征
		1. AutoEncoder
		2. GAN
		3. 可预测性建模
		4. 自监督分类
	2. 异常测量相关特征学习
		1. 基于距离的测度
		2. One-class 分类测度：正常的数据都来自于一个类，而异常数据不符合
		3. 基于聚类的测度
2. 方法1的优缺点：
	1. 优点：
		1. 可以利用现有深度模型（如autoencoder GAN等进行异常检测）
		2. 学习到的特征比[[深度学习下的异常检测——挑战、方法和机遇#深度学习特征提取]]更有效
	2. 缺点：
		1. 模型通常受限于特定数据
		2. 类似于GAN等模型在训练阶段的计算成本高
		3. 大多数方法对异常污染敏感，无法进行无监督的学习
3. 方法2的优缺点：
	1. 优点：
		1. 有传统方法的坚实基础
		2. 处理专门针对异常测量优化的低维特征表示，从而实现更有效的检测
	2. 缺点：
		1. 异常检测的性能在很大程度上取决于具体的异常措施
		2. 聚类过程可能会因训练数据中受污染的异常而产生偏差

#### 端到端的异常评分学习
> 以端到端的方式直接学习学习异常得分

##### 排序模型
1. 学习一个与异常样本的绝对/相对排序关系相关的排序模型（有序序列能够捕获数据异常）
2. 具体模型：
	1. Deep ordinal regression（优点类似于EM算法？？）
	2. Pairwise relation prediction (PReNet)

##### 先验驱动模型
1. 对异常分数施加先验以推动异常分数学习(假设强加的先验能够捕获数据集潜在的正常和异常样本)
2. 具体模型：
	1. Deviation networks (DevNet)

##### Softmax 似然模型
1. 通过最大化训练数据中事件的似然来学习异常分数（假设异常和正常实例分别是低概率事件和高概率事件）
2. 具体模型：
	1. APE

##### 端到端 one-class 分类
1. 训练 one-class 分类器，该分类器以端到端的方式区分给定实例是否正常
2. 具体模型：
	1. OCAN

##### [[深度学习下的异常检测——挑战、方法和机遇#端到端的异常评分学习]] 中各类方法的优缺点：
1. 优点
	1. 以端到端的方式进行优化，通常比其他两种方法更有效
	2. 不依赖于任何异常测度
2. 缺点：
	1. 至少需要某种形式的标记/合成异常样本
	2. 可能无法推广到表现出与标记异常不同的异常特征（未看见的异常）


### 监督信息视角

#### 无监督方法
1. 异常感知自编码器
2. 伪标签
3. one-class 模型、软边界
4. 增强深度聚类

#### 弱监督方法
1. 对比特征学习
2. 先验驱动的方法
3. 代理学习
4. 强化学习
5. 多实例学习

#### 半监督方法
1. GAN
2. 可预测建模
3. 自监督分类
4. 端到端one-class 分类

## 未来研究方向
1. 无监督
2. 自监督分类
3. 异常测度驱动
4. Few-shot 异常检测
5. 未知异常检测
6. 使用粗粒度异常标签学习检测模型
7. 大范围的异常学习
8. 复杂异常的深度检测（多模态、条件异常、组异常等）
9. 可表达、可实践的深度异常检测
10. 新的应用场景